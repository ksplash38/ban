function switchLanguage(d,b,c,a){if(b==null||b==undefined){return}if("undefined"!=typeof menuEventHandler&&menuEventHandler){menuEventHandler.fireEvent("menuItemClicked",b)}var f="/app/settings/savePreferredLocale";if(Ext.isEmpty(c)){f="/app/settings/setPreferredLocale"}var e={};if(Ext.isIE){e={Connection:"close"}}Ext.Ajax.extraParams="CSRFToken="+a;Ext.Ajax.request({url:d+f,params:{selectedLocale:b},headers:e,method:"POST",success:function(g,h){if(g.status===200){try{var i=Ext.decode(g.responseText,true);if(i!=null&&i.model!=null&&i.model.result==="success"){if(typeof pageName!=="undefined"&&pageName==="home"){var j=b.toLowerCase();if(j==="es_es"){j="spanish"}else{if(j==="zh_tw"){j="chinese"}else{j="english"}}var k={};if(Ext.isIE){k={Connection:"close"}}Ext.Ajax.request({url:ifs.ibContext+"UserOptions.cgi",method:"POST",headers:k,params:{language:j,runmode:"ChangeLanguage"},success:function(m,n){window.location.reload(true)},failure:function(m,n){}})}else{if(typeof(localeChoiceURL)==="undefined"||localeChoiceURL==null||localeChoiceURL.length<=0){window.location.reload()}else{window.location.replace(localeChoiceURL)}}}}catch(l){}}},failure:function(g,h){}})};